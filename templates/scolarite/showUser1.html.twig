{% extends 'template.html.twig' %}
{% block body %}
            

            <!--end breadcrumb-->
    <div class="card  border-top border-primary border-0">
        <div class="card-body">
            <div class="row">
                <div class="col-12">
                    {% include "flaches.html.twig" %}
                    <div class="card border shadow-none">
                        <div class="card-header py-3">
                            <div class="row align-items-center g-3">
                                <div class="col-12 col-lg-6">
                                    <h5 class="mb-0">{{ etudiant.LIB_NOM_PAT_IND }} {{ etudiant.LIB_PR1_IND}}</h5>
                                </div>
                                <div class="col-12 col-lg-6 text-md-end"> 
                                </div>
                            </div>
                        </div>
                        <div class="card-header py-2 bg-light">
                            <div class="row row-cols-1 row-cols-lg-1">
                                {% include "elements/info_etudiant.html.twig" %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
        </div>
    </div>
    <div class="row">
        <div class="col-12 col-lg-8 ">
            {% if ins_Peda_E is not empty %}
                <div class="card  border-top border-success border-0 ">
                    <div class="card-body">
                        <div class="card-header py-3">
                            <div class="row align-items-center g-3">
                                <div class="col-12 col-lg-6">
                                    <h5 class="mb-0">{{ins_Peda_E[0].COD_ETP}},{{ins_Peda_E[0].COD_ANU}}</h5>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12">
                                <div class="card border shadow-none radius-10">
                                    <div class="card-body">
                                        <div class="table-responsive">
                                            <table class="table table-bordered mb-0" style="font-weight:bold;" >
                                                <thead class="bg-light-primary">
                                                    <tr>
                                                        <th style="text-align:center !important ;" scope="col" colspan="2">{{'intitule'|trans}}</th>
                                                        <th style="text-align:center !important ;" scope="col">{{'note_sur_20'|trans}}(/20)</th>
                                                        <th style="text-align:center !important ;" scope="col">{{'pts_jury'|trans}}</th>
                                                        <th style="text-align:center !important ;" scope="col">{{'resultat'|trans}}</th>
                                                        <th style="text-align:center !important ;" scope="col">{{'session'|trans}}</th>
                                                        <th style="text-align:center !important ;" scope="col">{{'annee_univ'|trans}}</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    {% for det in details %}
                                                        {% if 'SE' in det.COD_NEL  %}
                                                            <tr class="" style="background-color:#FFD580;" >
                                                                <td style="text-align:center !important ;" colspan="2">{{det.LIB_ELP}}</td>
                                                                {% if det.BAR_NOT_ELP != 0  %}
                                                                    <td style="text-align:center !important ;">{{det.NOT_ELP}}</td>
                                                                    <td style="text-align:center !important ;">{{det.NOT_PNT_JUR_ELP}}</td>
                                                                    <td style="text-align:center !important ;">{{det.COD_TRE}}</td>
                                                                    <td style="text-align:center !important ;">{{det.COD_SES}}</td>
                                                                    <td style="text-align:center !important ;">{{det.COD_ANU}}/{{det.COD_ANU + 1}}</td>
                                                                {% else %}
                                                                    <td colspan="5" style="text-align:center" class="text-success">  </td>
                                                                {% endif %}
                                                            </tr>
                                                        {% elseif 'MO' in det.COD_NEL %}
                                                            <tr style="background-color:#d7f2f3;"> 
                                                                <td style="text-align:center !important ;" colspan="2">{{det.LIB_ELP}}</td>
                                                                {% if det.BAR_NOT_ELP != 0  %}
                                                                    <td style="text-align:center !important ;">{{det.NOT_ELP}}</td>
                                                                    <td style="text-align:center !important ;">{{det.NOT_PNT_JUR_ELP}}</td>
                                                                    <td style="text-align:center !important ;">{{det.COD_TRE}}</td>
                                                                    <td style="text-align:center !important ;">{{det.COD_SES}}</td>
                                                                    <td style="text-align:center !important ;">{{det.COD_ANU}}/{{det.COD_ANU + 1}}</td>
                                                                {% else %}
                                                                    <td colspan="5" style="text-align:center" class="text-success">  </td>
                                                                {% endif %}
                                                            </tr>
                                                        {% else %}
                                                            <tr style="background-color:white;">
                                                                <td width="10%"></td>
                                                                <td>{{det.LIB_ELP}}</td>
                                                                {% if det.BAR_NOT_ELP != 0  %}
                                                                    <td style="text-align:center !important ;">{{det.NOT_ELP}}</td>
                                                                    <td style="text-align:center !important ;">{{det.NOT_PNT_JUR_ELP}}</td>
                                                                    <td style="text-align:center !important ;">{{det.COD_TRE}}</td>
                                                                    <td style="text-align:center !important ;">{{det.COD_SES}}</td>
                                                                    <td style="text-align:center !important ;">{{det.COD_ANU}}/{{det.COD_ANU + 1}}</td>
                                                                {% else %}
                                                                    <td colspan="5" style="text-align:center" class="text-success"></td>
                                                                {% endif %}
                                                            </tr>
                                                        {% endif %}
                                                    {% endfor %}
                                                    {% for det1 in details1 %}
                                                            {% if (det1.COD_TRE=="ADM" or det1.COD_TRE=="ADMR" ) %} 
                                                                <tr class="bg-light-success">
                                                            {% else %}
                                                                <tr class="bg-light-danger">
                                                            {% endif %}
                                                                <td style="text-align:center !important ;" colspan="2">{{det1.COD_ETP}}</td>
                                                                <td style="text-align:center !important ;">{{det1.NOT_VET}}</td>
                                                                <td style="text-align:center !important ;">{{det1.NOT_PNT_JUR_VET}}</td>
                                                                <td style="text-align:center !important ;">{{det1.COD_TRE}}</td>
                                                                <td style="text-align:center !important ;">{{det1.COD_SES}}</td>
                                                                <td style="text-align:center !important ;">{{det1.COD_ANU}}/{{det1.COD_ANU + 1}}</td>
                                                            </tr>
                                                    {% endfor %}
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div><!--end row-->

                    </div>
                </div>
            {% else %}
			    <div class="alert alert-success">
			        <strong>{{'MOD_EMPTY_NOTES'|trans}} </strong> 
			    </div>
			{% endif %}
        </div>
        <div class="col-12 col-lg-4">
            <div class="card  border-top border-danger border-0 ">
                <div class="card-body">
                    <div class="card-header py-3">
                        <div class="row align-items-center g-3">
                            <div class="col-12 col-lg-6">
                                <h5 class="mb-0"> {{'resultat'|trans}}</h5>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            <div class="card border shadow-none radius-10">
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-bordered mb-0 table-striped" style="text-align:center !important ; font-weight:bold;" >
                                            <thead class="bg-light-primary">
                                                <tr>
                                                    <th style="text-align:center !important ;" scope="col">{{'annee'|trans}}</th>
                                                    <th style="text-align:center !important ;" scope="col">{{'etape'|trans}}</th>
                                                    <th style="text-align:center !important ;" scope="col">{{'moy_annuelle'|trans}}</th>
                                                    <th style="text-align:center !important ;" scope="col">{{'resultat'|trans}}</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {% for res in res_etudiant %}
                                                    <tr>
                                                        <td class="sorting_1">{{res.COD_ANU}}</td>
                                                        <td>{{res.COD_ETP}}</td>
                                                        <td>{{res.NOT_VET}}</td>
                                                        <td>{{res.COD_TRE}}</td>
                                                    </tr>
                                                {% endfor %}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                 
                            </div>
                            <a class="btn btn-primary col-3" href="{{ path('app_resultat', { 'id': user.id }) }}"  style="margin-bottom: 5px; float:right">{{'detail'|trans}}</a>
                        </div>

                    </div><!--end row-->

                </div>
            </div>
        </div>
    </div>
{% if (is_granted("ROLE_PROF") == false) %}
    <div class="card">
		<div class="card-body">
			<ul class="nav nav-pills nav-pills-success mb-3" role="tablist">
				<li class="nav-item" role="presentation">
					<a class="nav-link active" data-bs-toggle="pill" href="#danger-pills-home" role="tab" aria-selected="true">
						<div class="d-flex align-items-center">
							<div class="tab-icon"><i class='bi bi-file-ruled font-18 me-1'></i>
							</div>
							<div class="tab-title">{{'releve'|trans}} / {{'att_reussite'|trans}}</div>
						</div>
					</a>
				</li>
				<li class="nav-item" role="presentation">
					<a class="nav-link" data-bs-toggle="pill" href="#danger-pills-profile" role="tab" aria-selected="false">
						<div class="d-flex align-items-center">
							<div class="tab-icon"><i class='bi bi-person-vcard-fill font-18 me-1'></i>
							</div>
						    <div class="tab-title">{{'diplome'|trans}} / {{'carte_etudiant'|trans}}</div>
					    </div>
					</a>
				</li>
				<li class="nav-item" role="presentation">
					<a class="nav-link" data-bs-toggle="pill" href="#danger-pills-contact" role="tab" aria-selected="false">
						<div class="d-flex align-items-center">
							<div class="tab-icon"><i class='bi bi-file-earmark-text font-18 me-1'></i>
							</div>
							<div class="tab-title">{{'attestation_sco'|trans}}</div>
						</div>
					</a>
				</li>
			</ul>

			<div class="tab-content" id="danger-pills-tabContent">
				<div class="tab-pane fade show active" id="danger-pills-home" role="tabpanel">
					{% if releves is not empty %} 
                        <div class="table-responsive">
                            <table id="example" class="table table-striped table-bordered" style="text-align:center !important ;" >
                                <thead>
                                <tr>
                                    <th style="text-align:center !important ;">{{'date_demande'|trans}}</th>
                                    <th style="text-align:center !important ;">{{'type'|trans}}</th>  
                                    <th style="text-align:center !important ;">{{'etape'|trans}}</th>
                                    <th style="text-align:center !important ;">{{'date_validation'|trans}}</th>  
                                    <th style="text-align:center !important ;">{{'etat'|trans}}</th>
                                    <th style="text-align:center !important ;">{{'motif_refus'|trans}}</th>
                                    <th style="text-align:center !important ;">{{'op'|trans}}</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for releve in releves %}
                                    <tr>
                                        <td class="sorting_1">{{releve.dateDemande ? releve.dateDemande|date('d-m-Y H:i:s') : '' }}</td>
                                        <td>{{releve.type}}</td>
                                        <td>{{releve.codeEtape}}</td>
                                        <td>{{releve.dateValidation ? releve.dateValidation|date('d/m/Y') : '' }}</td>
                                        <td>
                                        
                              
                                         {% if releve.decision == -1 %} 
                                           <label style="color:black;font-weight:bold;"> {{'encours'|trans}}</label>  
                                    {% endif %}

                                     {% if releve.decision == -2 %} 
                                          <label style="color:black;font-weight:bold;"> {{'encours_sign'|trans}}</label>     
                                    {% endif %}


                                    {% if releve.decision == 0 %} 
                                           <label style="color:red;font-weight:bold;"> {{'refuse'|trans}}</label>    
                                    {% endif %}

                                      {% if releve.decision == 1 %} 
                                          <label style="color:green;font-weight:bold;"> {{'accorde'|trans}}</label>     
                                    {% endif %}
                                        

                                 
                                        
                                        </td>
                                        <td>{{releve.motif}}</td>
                                        <td>
                                            <div class="text-center">
                                                <a class="text-danger icons" onclick="return confirm('Are you sure you want to delete this item?');" data-toggle="tooltip" data-placement="top" title="supprimer" href="{{ path('removedoc', { 'id': releve.id ,'type':'releve'}) }}"><span class="fa fa-remove"></span>
                                                </a>
                                            </div>
                                        </td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            
                            </table>
                        </div>
                    {% else %}
                        <div class="alert alert-success">
                            <strong>{{'MOD_EMPTY_DEM'|trans}} </strong>  
                        </div>
                    {% endif %}
				</div>
				<div class="tab-pane fade" id="danger-pills-profile" role="tabpanel">
					{% if diplomes is not empty %} 
                        <div class="table-responsive">
                            <table id="example4" class="table table-striped table-bordered" style="text-align:center !important ;" >
                                <thead>
                                <tr>
                                    <th style="text-align:center !important ;">{{'date_demande'|trans}}</th>
                                    <th style="text-align:center !important ;">{{'type'|trans}}</th>  
                                    <th style="text-align:center !important ;">{{'etape'|trans}}</th>
                                    <th style="text-align:center !important ;">{{'date_validation'|trans}}</th>  
                                    <th style="text-align:center !important ;">{{'etat'|trans}}</th>
                                    <th style="text-align:center !important ;">{{'motif_refus'|trans}}</th>
                                    <th style="text-align:center !important ;">{{'op'|trans}}</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for diplome in diplomes %}
                                    <tr>
                                        <td class="sorting_1">{{diplome.dateDemande ? diplome.dateDemande|date('d-m-Y H:i:s') : '' }}</td>
                                        <td>{{diplome.type}}</td>
                                        <td>{{diplome.valueType}}</td>
                                        <td>{{diplome.dateValidation ? diplome.dateValidation|date('d/m/Y') : '' }}</td>




                                        <td>
                                        
                               
                                        

                                   {% if diplome.decision == -1 %} 
                                           <label style="color:black;font-weight:bold;"> {{'encours'|trans}}</label>  
                                    {% endif %}

                                     {% if diplome.decision == -2 %} 
                                          <label style="color:black;font-weight:bold;"> {{'encours_sign'|trans}}</label>     
                                    {% endif %}


                                    {% if diplome.decision == 0 %} 
                                           <label style="color:red;font-weight:bold;"> {{'refuse'|trans}}</label>    
                                    {% endif %}

                                      {% if diplome.decision == 1 %} 
                                          <label style="color:green;font-weight:bold;"> {{'accorde'|trans}}</label>     
                                    {% endif %}
                                        

                              
                                        
                                        
                                        
                                        </td>

                                        <td>{{diplome.motif}}</td>
                                        <td>
                                            <div class="text-center">
                                                <a class="text-danger icons"  onclick="return confirm('Are you sure you want to delete this item?');" data-toggle="tooltip" data-placement="top" title="supprimer" href="{{ path('removedoc', { 'id': diplome.id ,'type':'carte'}) }}"><span class="fa fa-remove"></span>&nbsp;&nbsp;
                                                </a>
                                                <a style="float-left" class="text-success icons" data-toggle="tooltip" data-placement="top" title="afficher" href="{{ path('carteQR', { 'id': diplome.id }) }}"><span class="bi bi-search"> </span></a>
                                            </div>
                                        </td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            
                            </table>
                        </div>
                    {% else %}
                        <div class="alert alert-success">
                            <strong>{{'MOD_EMPTY_DEM'|trans}} !</strong>   
                        </div>
                    {% endif %}
				</div>
				<div class="tab-pane fade" id="danger-pills-contact" role="tabpanel">
					{% if attestations is not empty %} 
                        <div class="table-responsive">
                            <table id="example3" class="table table-striped table-bordered" style="text-align:center !important ;" >
                                <thead>
                                <tr>
                                    <th style="text-align:center !important ;">{{'date_demande'|trans}}</th>
                                    <th style="text-align:center !important ;">{{'date_validation'|trans}}</th>  
                                    <th style="text-align:center !important ;">{{'etat'|trans}}</th>
                                    <th style="text-align:center !important ;">{{'motif_refus'|trans}}</th>
                                    <th style="text-align:center !important ;">{{'op'|trans}}</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for atest in attestations %}
                                    <tr>
                                        <td class="sorting_1">{{atest.dateDemande ? atest.dateDemande|date('d-m-Y H:i:s') : '' }}</td>
                                        <td>{{atest.dateValidation ? atest.dateValidation|date('d-m-Y H:i:s') : '' }}</td>

                                        <td>

                         

                                   {% if atest.decision == -1 %} 
                                           <label style="color:black;font-weight:bold;"> {{'encours'|trans}}</label>  
                                    {% endif %}

                                     {% if atest.decision == -2 %} 
                                          <label style="color:black;font-weight:bold;"> {{'encours_sign'|trans}}</label>     
                                    {% endif %}


                                    {% if atest.decision == 0 %} 
                                           <label style="color:red;font-weight:bold;"> {{'refuse'|trans}}</label>    
                                    {% endif %}

                                      {% if atest.decision == 1 %} 
                                          <label style="color:green;font-weight:bold;"> {{'accorde'|trans}}</label>     
                                    {% endif %}
                                        



                                        </td>
                                        <td>{{atest.motif}}</td>
                                        <td>
		                              		<div class="text-center">
			                               		<a class="text-danger icons" onclick="return confirm('Are you sure you want to delete this item?');" data-toggle="tooltip" data-placement="top" title="supprimer" href="{{ path('removedoc', { 'id': atest.id ,'type':'attestation'}) }}"><span class="fa fa-remove"></span></a>
		                                	</div>
		                              	</td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            
                            </table>
                        </div>
                    {% else %}
                        <div class="alert alert-success">
                            <strong>{{'MOD_EMPTY_DEM'|trans}} </strong>  
                        </div>
                    {% endif %}
				</div>
			</div>
{% endif %}
		</div>
	</div>       
{% endblock %}
{% block javascripts %}
    {{ parent() }}
    {{ encore_entry_script_tags('tablesuivi') }}
{% endblock %}
    


